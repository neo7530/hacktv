diff '--exclude=.git' hacktv/Makefile hacktv_patch/Makefile
6c6
< OBJS    := hacktv.o common.o fir.o vbidata.o teletext.o wss.o video.o mac.o videocrypt.o videocrypts.o syster.o systerdes.o acp.o nicam728.o test.o ffmpeg.o file.o hackrf.o
---
> OBJS    := hacktv.o keyboard.o common.o fir.o vbidata.o teletext.o wss.o video.o mac.o videocrypt.o videocrypts.o syster.o systerdes.o acp.o nicam728.o test.o ffmpeg.o file.o hackrf.o
Common subdirectories: hacktv/cards and hacktv_patch/cards
Only in hacktv_patch: keyboard.c
Only in hacktv_patch: keyboard.h
Only in hacktv_patch: play.sh
Common subdirectories: hacktv/resources and hacktv_patch/resources
diff '--exclude=.git' hacktv/syster.c hacktv_patch/syster.c
84a85,97
> 
> 
> /* keyboard stuff */
> #include "keyboard.h"
> _Bool encryption;
> _Bool cutrotate;
> _Bool debug;
> char taste;
> uint8_t crmode;
> uint8_t dnr = 2;
> int off = 0;
> 
> 
151c164
< /* ECM messages from Premiere (The Nutty Professor recording) */
---
> /* random XTEA ECM messages  */
153,216c166,229
< { 0x006A1CA059D24162, { 0x15,0x3D,0x1B,0x5A,0xE3,0xD4,0x5D,0xAB,0x0E,0x4C,0xAB,0x9A,0x22,0x44,0x8E,0xAD } }, /* 0x00 */
< { 0x0284BC4B4BD4BC31, { 0x67,0x83,0x81,0xB3,0x25,0xB4,0x1D,0xC2,0x33,0x7B,0xC3,0xEC,0x13,0xE9,0xE6,0x2F } }, /* 0x01 */
< { 0x05FCFE681804D155, { 0x01,0x7B,0x04,0xB3,0xB4,0xC1,0x8A,0xF3,0x27,0xCD,0x85,0xCB,0xDF,0x0C,0x86,0x11 } }, /* 0x02 */
< { 0x1D3855DB2F906ED3, { 0xAB,0x37,0x7D,0xF5,0x4F,0x7B,0x04,0x88,0xE7,0x39,0xCB,0xAE,0xC6,0xA3,0xBD,0x60 } }, /* 0x03 */
< { 0x03DA00F9489770F7, { 0xD0,0x2F,0x44,0x9E,0xB6,0xA5,0xB4,0xC1,0xCE,0x3D,0x02,0x02,0x63,0x03,0x6F,0x24 } }, /* 0x04 */
< { 0x0EA29E5525195862, { 0xFE,0x29,0x91,0x23,0x64,0x3E,0x60,0x16,0xDE,0xE0,0xF5,0x97,0x5D,0x3E,0xD6,0x6E } }, /* 0x05 */
< { 0x0F77221D3104CBEB, { 0x96,0x28,0x6C,0xF6,0x07,0xC8,0x36,0xC2,0x5B,0x85,0x80,0x25,0x29,0xAB,0xE7,0xA6 } }, /* 0x06 */
< { 0x08E95E066DEA4FF4, { 0x3B,0x59,0x74,0xAB,0xE3,0x70,0x0D,0x0C,0xC6,0x09,0x42,0x1E,0x80,0xA9,0xBD,0xF5 } }, /* 0x07 */
< { 0x0D9E740561008817, { 0xD4,0x96,0xE8,0x82,0x95,0xC0,0x46,0x69,0xB3,0x5D,0xE8,0x3C,0xCB,0xD5,0x37,0x36 } }, /* 0x08 */
< { 0x06D507F33743BA07, { 0x0C,0x8A,0x39,0x66,0xF9,0x81,0xB3,0xF3,0x78,0xCC,0x4F,0x20,0xF1,0xFF,0x1A,0x89 } }, /* 0x09 */
< { 0x140DA3217EA51F2D, { 0x94,0xE7,0x8D,0x74,0x64,0xE7,0x1C,0x8B,0x29,0x33,0xE0,0x75,0x7C,0x21,0xF4,0x24 } }, /* 0x0A */
< { 0x12908508768EE5DD, { 0x7C,0xE3,0xBE,0xA9,0xDB,0x88,0xBF,0xB9,0x88,0x5F,0x78,0x36,0xBB,0xF5,0xA3,0xC8 } }, /* 0x0B */
< { 0x0D55A58433000C19, { 0x85,0x9B,0xF0,0x2E,0x90,0x00,0xD2,0xB8,0x7B,0x3A,0x4C,0xBB,0x7B,0xD1,0xE0,0x40 } }, /* 0x0C */
< { 0x0127A2FF1B6CA6FE, { 0xD3,0x0F,0xC7,0xD6,0x1B,0xE2,0x15,0x15,0xD8,0xD1,0x82,0x26,0x9A,0xBE,0x93,0xD5 } }, /* 0x0D */
< { 0x00C8F42B5D042AC5, { 0xFC,0xDB,0x25,0xD7,0x30,0x49,0x87,0x8F,0x02,0x5A,0x34,0x07,0x17,0x52,0x17,0xEE } }, /* 0x0E */
< { 0x16682F0941F1DD68, { 0x01,0x35,0xE5,0xEE,0x4E,0x0D,0xED,0x01,0x25,0xEC,0x43,0xBC,0x20,0x4A,0xE4,0xDA } }, /* 0x0F */
< { 0x01086DE174A780FC, { 0xE6,0xE8,0x0D,0xB7,0x4C,0x6F,0xB6,0x96,0xAC,0x87,0xB5,0x7E,0x42,0xE5,0x05,0xB3 } }, /* 0x10 */
< { 0x01027E5753DF616D, { 0x0D,0x8D,0xF5,0x74,0x4E,0x89,0x13,0x26,0xC9,0xEF,0x1E,0x9B,0x4D,0xD0,0xB9,0x77 } }, /* 0x11 */
< { 0x1B1898CA5ED9CC7B, { 0xB8,0x7D,0xFB,0x2A,0x1C,0x78,0x8E,0x17,0x30,0xBE,0x8E,0xB1,0xAD,0x9F,0x64,0x71 } }, /* 0x12 */
< { 0x1B3FF8665DAEFF40, { 0xBA,0x9B,0x7E,0x9A,0x7B,0x9D,0xB7,0xEB,0x12,0x4C,0x6D,0x8D,0x82,0x0A,0x91,0x11 } }, /* 0x13 */
< { 0x1B0C240A379F5AFE, { 0x6B,0xFF,0x9D,0xA0,0x73,0x97,0xED,0x43,0xAB,0xDB,0x8E,0x2A,0xAB,0x51,0x60,0xFB } }, /* 0x14 */
< { 0x1BE17E730CA94670, { 0x00,0x92,0xF4,0x76,0x69,0x24,0xBD,0xED,0x7C,0x51,0x4D,0xFD,0x93,0x83,0x0F,0x09 } }, /* 0x15 */
< { 0x1D383F0C01FC4791, { 0xC6,0xB9,0x82,0x39,0xCF,0x17,0x86,0xE4,0xC4,0x75,0x2D,0x5C,0x10,0xC7,0xB0,0xA6 } }, /* 0x16 */
< { 0x001680864ED644AF, { 0xFF,0x66,0x3B,0x89,0xFA,0x5B,0xA8,0x92,0x66,0x74,0xF3,0xBE,0x6B,0xDB,0xA5,0x76 } }, /* 0x17 */
< { 0x1F3B26E31A299FDB, { 0xC2,0x0B,0xD8,0x3B,0x31,0x74,0x99,0xA7,0x80,0x59,0x1B,0x5A,0xDC,0xC1,0x7B,0x04 } }, /* 0x18 */
< { 0x1A0C7ABB7FA73F45, { 0xDD,0xA6,0xBC,0x69,0x5D,0x35,0x7F,0xE2,0xED,0x2D,0xDA,0xF8,0x85,0x25,0x24,0xAA } }, /* 0x19 */
< { 0x09B845E71387757F, { 0xB0,0x40,0xFF,0x71,0xD9,0x12,0xEC,0x2E,0xB2,0x5C,0x14,0xDA,0x57,0x0D,0x34,0x2C } }, /* 0x1A */
< { 0x092448372C8B5D92, { 0x52,0xEB,0xD2,0x07,0x0C,0x20,0x92,0xB0,0x12,0x71,0x31,0x4A,0x43,0x24,0x3D,0xEA } }, /* 0x1B */
< { 0x192DE0493F15AC9F, { 0x80,0xA5,0x43,0xC1,0xA2,0x68,0xAD,0x18,0x51,0x52,0xCC,0xEE,0x5D,0x84,0x14,0x8A } }, /* 0x1C */
< { 0x04CCE92274B67712, { 0x0C,0xB1,0x84,0x21,0x13,0x6C,0x27,0xDC,0xC5,0x2C,0x16,0x5E,0xC0,0x50,0x25,0x76 } }, /* 0x1D */
< { 0x0279F58C084AE008, { 0xB1,0x0E,0x0A,0x2E,0x83,0x98,0x5A,0xA6,0xD2,0x7E,0x58,0xF6,0x9E,0xE5,0x56,0xC0 } }, /* 0x1E */
< { 0x0E3DABAB10EDF9E1, { 0x09,0xFD,0x39,0x38,0xB7,0x3E,0x44,0x30,0x42,0xDD,0x4E,0x1A,0x0E,0xF9,0x0E,0x9C } }, /* 0x1F */
< { 0x156E38BF4E330F1C, { 0xEA,0x39,0x27,0xCC,0x62,0x7E,0x1E,0xC3,0x75,0x3C,0x5F,0x0B,0x22,0xCF,0x53,0xAA } }, /* 0x20 */
< { 0x05D6ECD46DF94551, { 0x85,0xC8,0x74,0xE1,0x82,0x68,0xDE,0xDE,0x8D,0x83,0x20,0x3D,0x1E,0xB8,0xAA,0x83 } }, /* 0x21 */
< { 0x16FDD8D66B499A6F, { 0x26,0xE8,0x0D,0xE1,0x65,0xAA,0x9C,0xF0,0xFE,0xD9,0xD4,0x64,0x10,0x2F,0x09,0x6D } }, /* 0x22 */
< { 0x07D6441441B69D78, { 0x2C,0x55,0x42,0x0F,0x26,0xC9,0x98,0x54,0xB2,0x2F,0x31,0x8D,0x53,0x8B,0xC6,0x55 } }, /* 0x23 */
< { 0x102C53F7027794E2, { 0x7D,0xDB,0xAC,0xE7,0xF5,0xE3,0x93,0x74,0xB9,0xFA,0xE6,0x8E,0xAB,0x22,0xCB,0xEA } }, /* 0x24 */
< { 0x10EAF127331EA737, { 0x79,0x81,0x15,0x33,0xD0,0xD8,0xC8,0xCC,0x34,0x5D,0xF0,0x48,0xC9,0x6B,0x84,0xF5 } }, /* 0x25 */
< { 0x08AAAAA303DDE859, { 0x3C,0xE6,0x91,0x0A,0x97,0xBB,0xB7,0x8A,0xC9,0x85,0x5A,0xC8,0xD0,0x29,0xCE,0xD0 } }, /* 0x26 */
< { 0x08FD46CF507733CF, { 0x9D,0xDD,0x31,0x3C,0x12,0x28,0x40,0xC0,0x1F,0x3A,0x38,0xBD,0xC4,0x69,0x45,0x71 } }, /* 0x27 */
< { 0x00F4242A092BFA7A, { 0x6B,0x03,0xDC,0x1A,0x20,0x6B,0x17,0xD6,0xD7,0x03,0xDC,0xEC,0xA9,0x7E,0x3E,0xB4 } }, /* 0x28 */
< { 0x13D16CC47644C92B, { 0xD0,0x09,0xD2,0x5C,0x9C,0xBB,0xFD,0xE9,0xBB,0x50,0xAC,0xD9,0x78,0x8A,0x1A,0x1C } }, /* 0x29 */
< { 0x1176D4954F30821F, { 0xD3,0x58,0xF8,0x69,0x2C,0x40,0xB5,0xA3,0x3D,0xCB,0xF8,0xA0,0x74,0xF7,0xFE,0xAE } }, /* 0x2A */
< { 0x044666E400123493, { 0x7B,0x8F,0x4B,0x1A,0x97,0x9A,0xC6,0x9F,0x69,0x8C,0xBA,0x7B,0x89,0xB4,0x40,0x50 } }, /* 0x2B */
< { 0x060DDE8B31867CB1, { 0x01,0x8E,0x3A,0xC0,0x3B,0x43,0x22,0xBE,0x51,0x71,0x1F,0xE8,0xAE,0x8A,0x7F,0x33 } }, /* 0x2C */
< { 0x01E132CA67F9F8F6, { 0x6B,0xC7,0x2D,0x2B,0xCE,0xB5,0x14,0x63,0x37,0x1F,0x3A,0x2E,0x93,0xAD,0xAC,0x9C } }, /* 0x2D */
< { 0x03C0D4FD79579136, { 0xE1,0x67,0x1A,0x60,0x48,0xFC,0xC9,0x2A,0xCE,0x9F,0x6E,0x4E,0xE1,0xF6,0x7A,0x3C } }, /* 0x2E */
< { 0x0E00E74C51487441, { 0xB6,0xE5,0xC8,0x69,0xFE,0xC4,0x81,0xA5,0xC5,0x18,0x70,0xE8,0xEA,0xE2,0x18,0x8A } }, /* 0x2F */
< { 0x0650FEAD1725C3E7, { 0xE9,0xA3,0xBC,0xCA,0xEF,0xD5,0xE8,0x47,0xBF,0x3B,0x04,0x60,0xA6,0xBC,0xAF,0x68 } }, /* 0x30 */
< { 0x1C2D0E7A49F7FFBF, { 0x37,0x5E,0x2A,0x34,0x8C,0x0C,0x9E,0xDC,0xA5,0x63,0xA2,0x32,0xF3,0x3E,0x29,0x5C } }, /* 0x31 */
< { 0x1E322D6525A2F285, { 0x03,0xC6,0xAE,0x5A,0x60,0xE1,0x6F,0x82,0xF9,0x46,0xCA,0x81,0xA7,0x9A,0xBE,0x6D } }, /* 0x32 */
< { 0x1298985465617D23, { 0xC5,0x33,0xF3,0x14,0xC5,0x94,0xEF,0xD2,0xA0,0xC0,0x3B,0x48,0x55,0x64,0x11,0xE5 } }, /* 0x33 */
< { 0x0C735F5F09A38145, { 0x3D,0x17,0xD8,0x98,0x93,0x03,0xF0,0x41,0xE5,0x26,0xC9,0x9B,0x0F,0x61,0xAE,0xC2 } }, /* 0x34 */
< { 0x15E9B6C33D0FDC51, { 0x95,0xB5,0xE0,0x56,0x36,0x84,0xAF,0x8A,0x5E,0x02,0xC5,0xA6,0x96,0x8C,0xAD,0x8D } }, /* 0x35 */
< { 0x0DEED2DC33F941AE, { 0x9A,0x1A,0x67,0xEC,0xB9,0xC9,0x1F,0xC6,0xAA,0x6E,0xC5,0xB2,0xEC,0x7B,0x15,0x7B } }, /* 0x36 */
< { 0x0673EC0423166CFE, { 0x5B,0xF1,0x1D,0x80,0x86,0xE9,0xAF,0x30,0xCB,0xAF,0xA7,0xB7,0x09,0xAE,0xE2,0xF8 } }, /* 0x37 */
< { 0x09862A7B4797B9B6, { 0xE4,0x1F,0xF6,0x05,0xCA,0x13,0x17,0x79,0x23,0xE2,0xC9,0x1B,0xDF,0x2C,0x9C,0x92 } }, /* 0x38 */
< { 0x1320B6B631CDDD91, { 0x39,0x0D,0x47,0x5C,0x39,0x7B,0xBB,0x24,0x0A,0xBA,0x3F,0x9E,0x4E,0x79,0xB6,0x3A } }, /* 0x39 */
< { 0x0893BAD665B0B13D, { 0x11,0xF5,0x03,0x4A,0xA0,0x6D,0x0D,0x18,0x82,0x48,0x31,0x46,0x6E,0x6E,0x92,0x56 } }, /* 0x3A */
< { 0x06CD358A0CB82602, { 0xA8,0x3C,0x1D,0x0A,0x5E,0x64,0xF9,0x3D,0xAE,0xCE,0x53,0x6F,0xBC,0xEC,0xBA,0xB4 } }, /* 0x3B */
< { 0x03CC15543DEEB44A, { 0xE6,0x40,0x15,0xF8,0xA7,0x60,0xD5,0xDE,0xBE,0xC6,0x4B,0x72,0x9D,0x78,0x4B,0x45 } }, /* 0x3C */
< { 0x03B8A8FC032E3529, { 0x60,0x66,0x7E,0xBC,0xA1,0x87,0x0A,0x5C,0x6D,0x8C,0xBD,0x37,0x60,0x3A,0x1A,0x39 } }, /* 0x3D */
< { 0x1046F4D86B914ACB, { 0x24,0xB1,0xF3,0x16,0x01,0x7C,0x50,0x5C,0x27,0x32,0x4B,0xFD,0x07,0x55,0x6E,0x93 } }, /* 0x3E */
< { 0x10EF953F72C02A66, { 0x35,0x67,0x73,0x86,0xF0,0x9E,0xC5,0x99,0xA0,0x03,0xDC,0xD7,0xEF,0x73,0xDF,0x5B } }, /* 0x3F */
---
> { 0x112AA4558B5C6856, { 0xD2, 0xA5, 0x15, 0xBF, 0xC2, 0xE3, 0x78, 0x7E, 0x37, 0xCF, 0xD9, 0x80, 0xB5, 0x9E, 0xF4, 0x3C}},
> { 0x1738D41FC5727D9A, { 0x0E, 0xA5, 0x77, 0xEE, 0xB5, 0x05, 0x96, 0x12, 0xF8, 0x08, 0x46, 0xFA, 0x30, 0xB7, 0x72, 0x6B}},
> { 0xB9B06B352CA15E94, { 0x05, 0x28, 0x37, 0x56, 0x02, 0x12, 0x18, 0x0E, 0x23, 0x1F, 0x36, 0x6C, 0xEF, 0x10, 0x89, 0x87}},
> { 0xBE7C1371F9D6A66B, { 0x07, 0xBF, 0x1E, 0x1F, 0xB0, 0x6F, 0x51, 0xFC, 0x63, 0x38, 0x05, 0x09, 0x22, 0xAD, 0x5D, 0x77}},
> { 0x4C1BAEEDCCEF0E49, { 0xF6, 0x41, 0x27, 0xD5, 0x9C, 0x03, 0x05, 0x0B, 0x17, 0xAD, 0x70, 0x52, 0x8C, 0x9B, 0xD8, 0x4E}},
> { 0x7D79305A1CBA0355, { 0xCB, 0x49, 0x03, 0xE6, 0xF9, 0xBC, 0xF0, 0x8A, 0x29, 0x34, 0xDB, 0xBE, 0x53, 0x34, 0x27, 0x21}},
> { 0x83051AC8FCA70BE4, { 0x0F, 0xB5, 0x96, 0x27, 0xCA, 0x0B, 0x3E, 0x71, 0x2E, 0xC9, 0xE9, 0x1F, 0x24, 0x0F, 0x87, 0x1D}},
> { 0x85AF765F9A254C5C, { 0x61, 0x29, 0x77, 0x50, 0x69, 0x63, 0x14, 0xD8, 0x83, 0xB0, 0x40, 0x22, 0x0B, 0x0C, 0x84, 0x31}},
> { 0xD474E8DBB9D62B84, { 0xF6, 0x8A, 0x74, 0x7B, 0x04, 0xBD, 0x06, 0x7D, 0x40, 0x47, 0x57, 0xA7, 0x98, 0x76, 0x82, 0xF4}},
> { 0x1586B65288630081, { 0x15, 0x83, 0x0B, 0xA9, 0x1B, 0x17, 0x9E, 0x43, 0x09, 0x33, 0x19, 0x02, 0x08, 0xD8, 0x53, 0x1C}},
> { 0x19C9E75E359502AE, { 0x97, 0x03, 0xF2, 0x3D, 0x03, 0xF0, 0xDC, 0xAD, 0xC9, 0x38, 0xD1, 0x54, 0x36, 0xD7, 0xF4, 0xBB}},
> { 0x423B1BCE700F5CE3, { 0x6E, 0xBD, 0x91, 0x7F, 0x66, 0xCE, 0xB0, 0x67, 0x74, 0x33, 0x1E, 0x45, 0xC8, 0xE0, 0xAD, 0xA8}},
> { 0x86A9682711A83D40, { 0x1A, 0xA7, 0x83, 0x1A, 0xC0, 0xB9, 0x82, 0xBE, 0xE8, 0xEB, 0x45, 0x09, 0x0D, 0x3D, 0xD7, 0xD3}},
> { 0x9D1DBC5CD3A2DD0F, { 0x35, 0x7B, 0x18, 0x9F, 0xE3, 0xBD, 0xAA, 0x23, 0x90, 0x37, 0xB0, 0x77, 0x27, 0x62, 0xC5, 0x05}},
> { 0x4DF029B1D9CBB8DE, { 0xE8, 0x3A, 0xD6, 0x00, 0x75, 0x6C, 0xF8, 0xAC, 0xF1, 0x6E, 0x00, 0x31, 0x16, 0x74, 0xDF, 0x63}},
> { 0xD07B2237FB260BC5, { 0x73, 0xA4, 0xF3, 0x16, 0x6D, 0x59, 0x2E, 0x93, 0x01, 0x3F, 0x0A, 0x23, 0x09, 0x0F, 0xD8, 0x1F}},
> { 0x06BEBB970B24BA28, { 0xAA, 0xC0, 0xDC, 0x1B, 0x99, 0x9E, 0x81, 0xB5, 0xD2, 0xE7, 0x92, 0x1F, 0xF6, 0x7B, 0xEC, 0x2D}},
> { 0xE9891BB475F1AE6C, { 0x73, 0x5B, 0xB1, 0x30, 0x1B, 0x57, 0x1B, 0x14, 0x24, 0x12, 0x8D, 0x84, 0xB3, 0xB8, 0xC9, 0xFF}},
> { 0x5122B4F19F86D3B6, { 0x49, 0x81, 0xC7, 0xD8, 0xE7, 0x25, 0x9C, 0x55, 0xFD, 0xC3, 0x65, 0xEA, 0xB7, 0x22, 0xE5, 0x78}},
> { 0xC29BBF2341874465, { 0xBB, 0x05, 0x25, 0x7B, 0x47, 0xAC, 0x95, 0x43, 0x4B, 0x04, 0x26, 0xDF, 0x7D, 0x48, 0xDC, 0x2D}},
> { 0x9EEE199B66F2ADD7, { 0xED, 0xFF, 0x08, 0xE4, 0x57, 0x15, 0x0B, 0x4A, 0xAA, 0x86, 0x57, 0x5D, 0xF6, 0x44, 0x09, 0x92}},
> { 0x2C8C0E7CF63503EA, { 0x16, 0x48, 0x5F, 0xC4, 0x89, 0x8C, 0xFA, 0xFD, 0x2D, 0x7F, 0x9D, 0x77, 0x83, 0xF9, 0x20, 0x4C}},
> { 0x0A7829053C74166D, { 0x01, 0x00, 0x4F, 0x2D, 0x22, 0xC3, 0xCF, 0x90, 0x9D, 0x45, 0xA2, 0x9D, 0xAA, 0x44, 0x53, 0x68}},
> { 0xC0B011347ECE870B, { 0x8D, 0x09, 0xB0, 0x18, 0xBC, 0x6E, 0xED, 0x5F, 0x9B, 0x34, 0xF3, 0x44, 0xFC, 0x35, 0xE8, 0x07}},
> { 0xE7E0C08204BBA783, { 0x2C, 0x8A, 0x8E, 0xDF, 0xC2, 0xC5, 0x29, 0x65, 0x3C, 0xCB, 0x09, 0xB4, 0xD7, 0xA5, 0x59, 0xDC}},
> { 0x2FC628C1F1A34BD1, { 0x68, 0x6C, 0xA9, 0xC3, 0xF7, 0x05, 0x4E, 0xC5, 0xC2, 0xF4, 0x92, 0x3A, 0x02, 0x13, 0xA9, 0xE2}},
> { 0x0D49C9CEFDB552A6, { 0x59, 0xE0, 0xF5, 0x67, 0xEF, 0xEF, 0x9A, 0x45, 0x52, 0xE3, 0x6C, 0x10, 0x44, 0xEB, 0xFE, 0x51}},
> { 0x2847101DC09E1329, { 0x30, 0xD7, 0x1B, 0x53, 0x93, 0x47, 0x3E, 0xCE, 0x73, 0xDD, 0x23, 0x52, 0xDB, 0x05, 0xF3, 0x06}},
> { 0x4A0B9B4E37896497, { 0xAF, 0x89, 0xF6, 0x73, 0xA1, 0x57, 0xE2, 0xEE, 0x82, 0xAE, 0x54, 0x0D, 0xC5, 0xB3, 0x5F, 0xA5}},
> { 0xD7690BCF874732FA, { 0xAF, 0xEF, 0x17, 0x95, 0x2B, 0x6A, 0x1F, 0x56, 0xC1, 0x30, 0x66, 0x5D, 0xE5, 0xDA, 0xF8, 0x1B}},
> { 0xAFA08B98A2647BF9, { 0x99, 0x49, 0x41, 0xEE, 0x14, 0x51, 0x03, 0x5C, 0x9B, 0x5F, 0x4A, 0x89, 0x91, 0x59, 0xC3, 0x7A}},
> { 0x9FFACC09CEFBC2B7, { 0xED, 0x99, 0xEE, 0x96, 0x96, 0xE1, 0x91, 0x7A, 0x49, 0x3A, 0x6A, 0xFD, 0xFA, 0x51, 0x7E, 0x29}},
> { 0xCE284A8D048E31C3, { 0xBE, 0x25, 0xC9, 0x07, 0xBE, 0x72, 0x3F, 0xCD, 0xF8, 0xB7, 0x84, 0x13, 0xE3, 0x6A, 0xE8, 0x82}},
> { 0x5337C9334A512715, { 0x34, 0xF9, 0x31, 0xA2, 0xED, 0x62, 0x76, 0x97, 0xE8, 0xC3, 0x00, 0x80, 0x79, 0xB5, 0x11, 0xC6}},
> { 0x604B857133E2796A, { 0x09, 0x62, 0xBC, 0x2B, 0x59, 0x90, 0x15, 0xBE, 0x23, 0x81, 0x83, 0xD1, 0xBA, 0x9D, 0x49, 0xCE}},
> { 0xF547D25821565BC1, { 0x0C, 0x74, 0xB2, 0x48, 0x8B, 0xE1, 0xED, 0x4A, 0xE5, 0xDF, 0xA6, 0xED, 0xE6, 0xA8, 0x89, 0x0E}},
> { 0xE177EC359A5FAC12, { 0xA1, 0x85, 0x8D, 0x05, 0xDF, 0xBF, 0x46, 0xEB, 0xF5, 0x17, 0xAB, 0x9A, 0x62, 0x22, 0x32, 0x56}},
> { 0xFFB03D4FA4DB8F9A, { 0x3F, 0xB0, 0x80, 0x53, 0x07, 0x95, 0x5A, 0x70, 0x5C, 0x67, 0xAC, 0x46, 0x3D, 0xE3, 0x62, 0x13}},
> { 0x19AD1B29CAE2777F, { 0xF0, 0x54, 0xED, 0x84, 0x88, 0x54, 0xD5, 0x51, 0x4F, 0xA9, 0xCA, 0x9B, 0x3F, 0xB4, 0x6A, 0x38}},
> { 0x223D94BEFE08D3ED, { 0xD5, 0x92, 0xEE, 0xD0, 0x3B, 0xF2, 0x5B, 0x26, 0x3E, 0x5A, 0xB2, 0x81, 0x52, 0xF5, 0x59, 0x72}},
> { 0xF8C810B09144F9B5, { 0x9F, 0xD3, 0xCD, 0xD4, 0xCD, 0xE5, 0x01, 0x2E, 0x2D, 0x0D, 0xC5, 0xCB, 0x9A, 0xEB, 0xC3, 0xA4}},
> { 0x33ABB4E6FE52A011, { 0x17, 0x3F, 0x8B, 0x0E, 0x3F, 0xAC, 0xD3, 0xC9, 0x02, 0xD5, 0xC6, 0xD9, 0xA1, 0xF5, 0x5F, 0x58}},
> { 0x3C9A776D223941C1, { 0x98, 0x46, 0x5D, 0x62, 0x67, 0x47, 0x4D, 0xFE, 0x08, 0x0B, 0xE6, 0x14, 0x1D, 0x0A, 0xFF, 0xD3}},
> { 0x5A2075CEF675766A, { 0x8F, 0x1B, 0x2A, 0x98, 0x6E, 0xBA, 0xE2, 0xF6, 0xAB, 0xF3, 0xE9, 0x34, 0xFE, 0xAB, 0xB7, 0xF1}},
> { 0x4010AA22E08786D4, { 0x02, 0x34, 0x0E, 0xDC, 0x50, 0x8D, 0x78, 0x7F, 0x4D, 0xE8, 0x5E, 0xF3, 0x26, 0xE8, 0x13, 0xEB}},
> { 0x94D4F6DBA36251D7, { 0x06, 0xCC, 0xDA, 0x3C, 0x5F, 0x4F, 0xE9, 0x8A, 0x22, 0x17, 0x69, 0x8B, 0x2E, 0xF4, 0x9C, 0x5F}},
> { 0x6D4B5C75AE110496, { 0x47, 0x61, 0x92, 0x2E, 0xC0, 0x0F, 0x84, 0xAE, 0xF7, 0x2E, 0x07, 0x0F, 0xBC, 0x12, 0xDD, 0x68}},
> { 0x1A0661403569F507, { 0x84, 0x37, 0xEE, 0x07, 0xEB, 0xE1, 0x8A, 0xA2, 0x5E, 0xC9, 0xC8, 0x20, 0xF4, 0xFF, 0x20, 0x41}},
> { 0x626598699FAC7975, { 0x10, 0xD2, 0xDA, 0x85, 0x2F, 0x5F, 0xB2, 0xC7, 0xF1, 0xC4, 0xB3, 0x30, 0x52, 0xD0, 0x62, 0x44}},
> { 0x77FEBEEE4C24DDE5, { 0x52, 0x80, 0xF6, 0x46, 0x2D, 0x25, 0xA5, 0x9C, 0x79, 0x84, 0xA1, 0x94, 0xC9, 0xA7, 0x8E, 0x37}},
> { 0x5E4E64E1BCBA2404, { 0x46, 0xCD, 0x16, 0x4E, 0x59, 0x54, 0x82, 0x47, 0xCD, 0x7F, 0x71, 0x81, 0x1F, 0x39, 0x0C, 0x71}},
> { 0x02781C225078C8BB, { 0xFA, 0x0C, 0xC3, 0x85, 0x7C, 0x10, 0x5B, 0x13, 0xA9, 0xA0, 0x11, 0x70, 0x61, 0x92, 0xD2, 0x36}},
> { 0x06ADC57888515751, { 0x12, 0xD5, 0xB8, 0x37, 0x34, 0x02, 0xB7, 0xEC, 0x37, 0xF8, 0xD9, 0xE1, 0x99, 0x2D, 0x33, 0x64}},
> { 0x6E6C5989DCBA88C3, { 0x44, 0x82, 0x66, 0x92, 0x72, 0xD7, 0x0E, 0xE5, 0xAA, 0xD5, 0x8C, 0x3C, 0xE3, 0x69, 0x2B, 0xBD}},
> { 0x810D1B916E3C7A8E, { 0xDD, 0xB1, 0x71, 0x2C, 0xFA, 0xBF, 0x50, 0xB2, 0x74, 0x1D, 0x7A, 0xC3, 0x56, 0xB8, 0x20, 0x03}},
> { 0x2FE1365BBB29AD7F, { 0x3A, 0xC5, 0x30, 0x7A, 0xE7, 0xEF, 0x5E, 0x2F, 0xC3, 0xE1, 0xD8, 0x01, 0x97, 0x9A, 0x5D, 0x03}},
> { 0xC987C104E7845C63, { 0x4F, 0x65, 0x31, 0x5A, 0x25, 0x1F, 0x8F, 0xD8, 0x1A, 0xB8, 0xF7, 0x6D, 0x81, 0x58, 0xBB, 0xFA}},
> { 0xF3CDF1D198470892, { 0x24, 0xFB, 0xB2, 0x8A, 0xF5, 0x0C, 0x2C, 0x4E, 0x0F, 0x68, 0xBC, 0x2E, 0x62, 0x64, 0x0A, 0x34}},
> { 0x006C5F3AA0BCDF77, { 0x53, 0x35, 0x29, 0x2E, 0x6D, 0xF7, 0xF5, 0xD8, 0x8E, 0xA5, 0xF6, 0xF5, 0xD0, 0xBC, 0xC1, 0x77}},
> { 0x97C4899FFBA0D02E, { 0x8C, 0x88, 0xBE, 0x4E, 0xF5, 0x25, 0x9A, 0xDF, 0xAA, 0x0B, 0x5E, 0xB3, 0x7C, 0xF0, 0xD2, 0x98}},
> { 0xD89C5A3391E5DCE9, { 0x11, 0xA8, 0xCC, 0x56, 0xCB, 0x5D, 0x43, 0x71, 0xF3, 0xBE, 0xBC, 0xCE, 0xB3, 0xBF, 0x57, 0x67}},
> { 0xDC7296E0C205AA08, { 0x3A, 0x12, 0x63, 0x95, 0x80, 0x6D, 0x08, 0xBF, 0xC2, 0xE5, 0xE5, 0xE6, 0x73, 0x1B, 0x57, 0x79}},
> { 0xA915E9AE74436080, { 0xF2, 0x83, 0xC8, 0xBE, 0x79, 0xA5, 0x79, 0xA0, 0xC6, 0x54, 0x14, 0x98, 0x0B, 0x01, 0x79, 0x2B}},
> { 0xCDA1C76002246FD3, { 0x37, 0x7D, 0xF3, 0x6A, 0x6E, 0x5B, 0x17, 0x0C, 0x91, 0x0B, 0x93, 0xA1, 0x50, 0x23, 0x61, 0x7F}},
464a478,499
> 	
> 	_keyboard_raw_mode(); /* Keyboard raw mode */
> 	if(_kbhit()){
> 		taste = getchar();
> 		if(taste == ' '){
> 			fprintf(stderr," ENCRYPTION-MODE CHANGE %d\n",!encryption);
> 			encryption = !encryption;
> 		}else if(taste == 'd'){
> 			fprintf(stderr," DEBUG-MODE CHANGE %d\n",!debug);
> 			debug = !debug;
> 		}else if(taste == 'c'){
> 			fprintf(stderr," CUT&ROTATE-MODE CHANGE %d\n",!cutrotate);
> 			cutrotate = !cutrotate;
> 		}else{}
> 	} else {}
> 
> 	if(encryption){
> 		crmode = mode;
> 	} else {
> 		crmode = 0x48;
> 	}
> 	_keyboard_dis_raw_mode();
490c525,530
< 			msg1[ 0] = mode;	/* Mode? (0x72 = Premiere / Canal+ Old, 0x48 = Clear, 0x7A or 0xFA) */
---
> 			if(cutrotate){
> 			  	msg1[ 0] = 0x74;	/* Mode? (0x72 = Premiere / Canal+ Old, 0x48 = Clear, 0x7A or 0xFA) */
> 			}else{
> 				msg1[ 0] = crmode;
> 			}
> 
501c541,545
< 			msg2[ 1] = 0x28;	/* ??? Premiere DE: 0x28, Canal+ PL: 0x2A */
---
> 			if(cutrotate){
> 				msg2[ 1] = 0x29;	/* ??? Premiere DE: 0x28, Canal+ PL: 0x2A */
> 			} else {
> 				msg2[ 1] = 0x28;
> 			}
519a564,569
> if(debug){
> 		fprintf(stderr,"\n");
> 		for(int i =0;i<28;i++){fprintf(stderr,"%02X ",s->vbi[s->vbi_seq][i]);}
> 		fprintf(stderr,"   S: %d R: %d VBI-LINE: %d FRAME: %d",s->s,s->r,line,s->vid->frame %25);
> }
> 
575a626,627
> 
> 	if(!encryption)i=0;
815a868,869
> 
> 	if(!encryption || cutrotate){j=0;}
diff '--exclude=.git' hacktv/videocrypt.c hacktv_patch/videocrypt.c
50c50,53
< #define SKY07_CHID 0x00	
---
> #define SKY07_CHID 0x00
> 
> 	uint8_t keyctr = 0;
> 	uint8_t eeprom = 0;
98c101,103
< 			 { }, { }, { }, { },{ },
---
> 			{ }, 
> 			{ 0xC0,0xF1,0x00,0x44,0x33,0x22,0x11,0x00,0xFF,0xFF,0xFF }, 
> 			{ }, { }, { },
106c111,113
<  			{ }, { }, { }, { },	{ },
---
>  			{ },
> 			{ 0xC0,0xF1,0x00,0x44,0x33,0x22,0x11,0x00,0xFF,0xFF,0xFF }, 
> 			{ }, { }, { },
237c244,246
<  			{ }, { }, { }, { },	{ },
---
>  			{ }, 
> 			{ 0xC0,0xF1,0x00,0x44,0x33,0x22,0x11,0x00,0xFF,0xFF,0xFF },  
> 			{ }, { }, { },
245c254,256
<  			{ }, { }, { }, { },	{ },
---
>  			{ }, 
> 			{ 0xC0,0xF1,0x00,0x44,0x33,0x22,0x11,0x00,0xFF,0xFF,0xFF },  
> 			{ }, { }, { },
647a659,683
> 				if(strcmp(mode,"tac1") == 0 || strcmp(mode,"tac2") == 0){
> 					/* KEY-UPDATE as plaintext */
> 					if((s->counter & 0x3F) == 0x10)
> 					{ fprintf(stderr,"KEY-UPDATE BLOCK \n");
> 						s->blocks[s->block].messages[((s->counter >> 3) & 7) % 7][2] = eeprom+1;
> 						for(x = 0; x < 16; x++){ s->blocks[s->block].messages[((s->counter >> 3) & 7) % 7][11+x] = tac_key[keyctr] & 0xff; keyctr++;}
> 						eeprom++;
> 						if(keyctr == 96){keyctr= 0;eeprom = 0;}
> 					}
>                                         /* TODO:ENCRYPT KEYUPDATE */
> 				}
> 
> 				if(strcmp(mode,"sky09") == 0){
>                                         /* KEY UPDATE as plaintext */
> 					if((s->counter & 0x3F) == 0x10)
>                                         { fprintf(stderr,"KEY-UPDATE BLOCK \n");
>                                                 s->blocks[s->block].messages[((s->counter >> 3) & 7) % 7][2] = eeprom+7;
>                                                 for(x = 0; x < 16; x++){ s->blocks[s->block].messages[((s->counter >> 3) & 7) % 7][11+x] = sky09_key[keyctr] & 0xff; keyctr++;}
>                                                 eeprom++;
> 						if(keyctr == 224){keyctr= 0;eeprom = 0;}
>                                         }
> 					/* TODO:ENCRYPT KEYUPDATE */
>                 }
> 				
> 				/* CRC */
650a687
> 					fprintf(stderr,"%02x ",s->blocks[s->block].messages[((s->counter >> 3) & 7) % 7][x]);
653a691,692
> 				fprintf(stderr,"%02x ",s->blocks[s->block].messages[((s->counter >> 3) & 7) % 7][31]);				
> 				fprintf(stderr,"Codeword: %08llx\n", s->cw);
684a724
> 					fprintf(stderr,"%02x ",s->blocks2[s->block2].messages[(s->counter >> 1) & 7][x]);
687a728,729
> 				fprintf(stderr,"%02x ",s->blocks2[s->block2].messages[(s->counter >> 1) & 7][31]);				
> 				fprintf(stderr,"Codeword: %08llx\n", s->cw);
